#pragma once

#include "type.h"
#include "ps4.h"

/*PS4 9.00
#define	KERN_XFAST_SYSCALL 0x000001C0//9
#define KERN_PROCESS_ASLR  0x5F824//9
#define KERN_PRISON_0      0x0111F870//9
#define KERN_ROOTVNODE     0x021EFF20//9
#define KERN_PTRACE_CHECK  0x41F4E5//9
*/

#define K300_XFAST_SYSCALL         0x0
#define K310_XFAST_SYSCALL         0x0
#define K311_XFAST_SYSCALL         0x0
#define K315_XFAST_SYSCALL         0x0
#define K350_XFAST_SYSCALL         0x003A1AD0
#define K355_XFAST_SYSCALL         0x003A1F10
#define K370_XFAST_SYSCALL         0x003A2000
#define K400_XFAST_SYSCALL         0x0030EA00
#define K401_XFAST_SYSCALL         0x0030EA00
#define K405_XFAST_SYSCALL         0x0030EB30
#define K406_XFAST_SYSCALL         0x0030EB40
#define K407_XFAST_SYSCALL         0x0030EB40
#define K450_XFAST_SYSCALL         0x003095D0
#define K455_XFAST_SYSCALL         0x003095D0
#define K470_XFAST_SYSCALL         0x0030B840
#define K471_XFAST_SYSCALL         0x0030B7D0
#define K472_XFAST_SYSCALL         0x0030B7D0
#define K473_XFAST_SYSCALL         0x0030B7D0
#define K474_XFAST_SYSCALL         0x0030B7D0
#define K500_XFAST_SYSCALL         0x000001C0
#define K501_XFAST_SYSCALL         0x000001C0
#define K503_XFAST_SYSCALL         0x000001C0
#define K505_XFAST_SYSCALL         0x000001C0
#define K507_XFAST_SYSCALL         0x000001C0
#define K550_XFAST_SYSCALL         0x000001C0
#define K553_XFAST_SYSCALL         0x000001C0
#define K555_XFAST_SYSCALL         0x000001C0
#define K556_XFAST_SYSCALL         0x000001C0
#define K600_XFAST_SYSCALL         0x000001C0
#define K602_XFAST_SYSCALL         0x000001C0
#define K620_XFAST_SYSCALL         0x000001C0
#define K650_XFAST_SYSCALL         0x000001C0
#define K651_XFAST_SYSCALL         0x000001C0
#define K670_XFAST_SYSCALL         0x000001C0
#define K671_XFAST_SYSCALL         0x000001C0
#define K672_XFAST_SYSCALL         0x000001C0
#define K700_XFAST_SYSCALL         0x000001C0
#define K701_XFAST_SYSCALL         0x000001C0
#define K702_XFAST_SYSCALL         0x000001C0
#define K750_XFAST_SYSCALL         0x000001C0
#define K751_XFAST_SYSCALL         0x000001C0
#define K755_XFAST_SYSCALL         0x000001C0
#define K800_XFAST_SYSCALL         0x000001C0
#define K801_XFAST_SYSCALL         0x000001C0
#define K803_XFAST_SYSCALL         0x000001C0
#define K850_XFAST_SYSCALL         0x000001C0
#define K852_XFAST_SYSCALL         0x000001C0
#define K900_XFAST_SYSCALL         0x000001C0
#define K903_XFAST_SYSCALL         0x000001C0
#define K904_XFAST_SYSCALL         0x000001C0
#define K950_XFAST_SYSCALL         0x000001C0
#define K951_XFAST_SYSCALL         0x000001C0
#define K960_XFAST_SYSCALL         0x000001C0
#define K1000_XFAST_SYSCALL        0x000001C0
#define K1001_XFAST_SYSCALL        0x000001C0
#define K1050_XFAST_SYSCALL        0x000001C0
#define K1070_XFAST_SYSCALL        0x000001C0
#define K1071_XFAST_SYSCALL        0x000001C0
#define K1100_XFAST_SYSCALL        0x000001C0
#define K1102_XFAST_SYSCALL        0x000001C0
#define K1150_XFAST_SYSCALL        0x000001C0
#define K1152_XFAST_SYSCALL        0x000001C0
#define K1200_XFAST_SYSCALL        0x000001C0
#define K1202_XFAST_SYSCALL        0x000001C0
#define K1250_XFAST_SYSCALL        0x000001C0
#define K1252_XFAST_SYSCALL        0x000001C0

#define K300_DISABLE_ASLR          0x0
#define K310_DISABLE_ASLR          0x0
#define K311_DISABLE_ASLR          0x0
#define K315_DISABLE_ASLR          0x0
#define K350_DISABLE_ASLR          0x00406942
#define K355_DISABLE_ASLR          0x00406E82
#define K370_DISABLE_ASLR          0x00407242
#define K400_DISABLE_ASLR          0x002861A6
#define K401_DISABLE_ASLR          0x002861A6
#define K405_DISABLE_ASLR          0x002862D6
#define K406_DISABLE_ASLR          0x002862D6
#define K407_DISABLE_ASLR          0x002862D6
#define K450_DISABLE_ASLR          0x001BA559
#define K455_DISABLE_ASLR          0x001BA559
#define K470_DISABLE_ASLR          0x001BC769
#define K471_DISABLE_ASLR          0x001BC769
#define K472_DISABLE_ASLR          0x001BC769
#define K473_DISABLE_ASLR          0x001BC769
#define K474_DISABLE_ASLR          0x001BC769
#define K500_DISABLE_ASLR          0x00194765
#define K501_DISABLE_ASLR          0x00194765
#define K503_DISABLE_ASLR          0x00194875
#define K505_DISABLE_ASLR          0x00194875
#define K507_DISABLE_ASLR          0x00194875
#define K550_DISABLE_ASLR          0x0007A123
#define K553_DISABLE_ASLR          0x0007A123
#define K555_DISABLE_ASLR          0x0007A123
#define K556_DISABLE_ASLR          0x0007A123
#define K600_DISABLE_ASLR          0x0021D745
#define K602_DISABLE_ASLR          0x0021D745
#define K620_DISABLE_ASLR          0x0021D745
#define K650_DISABLE_ASLR          0x003CE931
#define K651_DISABLE_ASLR          0x003CE931
#define K670_DISABLE_ASLR          0x003CECE1
#define K671_DISABLE_ASLR          0x003CECE1
#define K672_DISABLE_ASLR          0x003CEC8A
#define K700_DISABLE_ASLR          0x000C1F9A
#define K701_DISABLE_ASLR          0x000C1F9A
#define K702_DISABLE_ASLR          0x000C1F9A
#define K750_DISABLE_ASLR          0x00218AF4
#define K751_DISABLE_ASLR          0x00218AF4
#define K755_DISABLE_ASLR          0x00218AF4
#define K800_DISABLE_ASLR          0x002856F4
#define K801_DISABLE_ASLR          0x002856F4
#define K803_DISABLE_ASLR          0x002856F4
#define K850_DISABLE_ASLR          0x00215154
#define K852_DISABLE_ASLR          0x00215154
#define K900_DISABLE_ASLR          0x0005F824
#define K903_DISABLE_ASLR          0x0005F824
#define K904_DISABLE_ASLR          0x0005F824
#define K950_DISABLE_ASLR          0x0029AE74
#define K951_DISABLE_ASLR          0x0029AE74
#define K960_DISABLE_ASLR          0x0029AE74
#define K1000_DISABLE_ASLR         0x003BF3A4
#define K1001_DISABLE_ASLR         0x003BF3A4
#define K1050_DISABLE_ASLR         0x00345E04
#define K1070_DISABLE_ASLR         0x00345E04
#define K1071_DISABLE_ASLR         0x00345E04
#define K1100_DISABLE_ASLR         0x003B11A4
#define K1102_DISABLE_ASLR         0x003B11C4
#define K1150_DISABLE_ASLR         0x00477A14
#define K1152_DISABLE_ASLR         0x00477A14
#define K1200_DISABLE_ASLR         0x00477C54
#define K1202_DISABLE_ASLR         0x00477C54
#define K1250_DISABLE_ASLR         0x00477C94
#define K1252_DISABLE_ASLR         0x00477C94

#define K300_PRISON_0              0x0
#define K310_PRISON_0              0x0
#define K311_PRISON_0              0x0
#define K315_PRISON_0              0x0
#define K350_PRISON_0              0x00EF5A00
#define K355_PRISON_0              0x00EF5A00
#define K370_PRISON_0              0x00EFEF10
#define K400_PRISON_0              0x00F26010
#define K401_PRISON_0              0x00F26010
#define K405_PRISON_0              0x00F26010
#define K406_PRISON_0              0x00F26010
#define K407_PRISON_0              0x00F2A010
#define K450_PRISON_0              0x010399B0
#define K455_PRISON_0              0x010399B0
#define K470_PRISON_0              0x01042AB0
#define K471_PRISON_0              0x01042AB0
#define K472_PRISON_0              0x01042AB0
#define K473_PRISON_0              0x01042AB0
#define K474_PRISON_0              0x01042AB0
#define K500_PRISON_0              0x010986A0
#define K501_PRISON_0              0x010986A0
#define K503_PRISON_0              0x010986A0
#define K505_PRISON_0              0x010986A0
#define K507_PRISON_0              0x010986A0
#define K550_PRISON_0              0x01134180
#define K553_PRISON_0              0x01134180
#define K555_PRISON_0              0x01139180
#define K556_PRISON_0              0x01139180
#define K600_PRISON_0              0x01139458
#define K602_PRISON_0              0x01139458
#define K620_PRISON_0              0x0113D458
#define K650_PRISON_0              0x0113D4F8
#define K651_PRISON_0              0x0113D4F8
#define K670_PRISON_0              0x0113E518
#define K671_PRISON_0              0x0113E518
#define K672_PRISON_0              0x0113E518
#define K700_PRISON_0              0x0113E398
#define K701_PRISON_0              0x0113E398
#define K702_PRISON_0              0x0113E398
#define K750_PRISON_0              0x0113B728
#define K751_PRISON_0              0x0113B728
#define K755_PRISON_0              0x0113B728
#define K800_PRISON_0              0x0111A7D0
#define K801_PRISON_0              0x0111A7D0
#define K803_PRISON_0              0x0111A7D0
#define K850_PRISON_0              0x0111A8F0
#define K852_PRISON_0              0x0111A8F0
#define K900_PRISON_0              0x0111F870
#define K903_PRISON_0              0x0111B840
#define K904_PRISON_0              0x0111B840
#define K950_PRISON_0              0x011137D0
#define K951_PRISON_0              0x011137D0
#define K960_PRISON_0              0x011137D0
#define K1000_PRISON_0             0x0111B8B0
#define K1001_PRISON_0             0x0111B8B0
#define K1050_PRISON_0             0x0111B910
#define K1070_PRISON_0             0x0111B910
#define K1071_PRISON_0             0x0111B910
#define K1100_PRISON_0             0x0111F830
#define K1102_PRISON_0             0x0111F830
#define K1150_PRISON_0             0x0111FA18
#define K1152_PRISON_0             0x0111FA18
#define K1200_PRISON_0             0x0111FA18
#define K1202_PRISON_0             0x0111FA18
#define K1250_PRISON_0             0x0111FA18
#define K1252_PRISON_0             0x0111FA18

#define K300_ROOTVNODE             0x0
#define K310_ROOTVNODE             0x0
#define K311_ROOTVNODE             0x0
#define K315_ROOTVNODE             0x0
#define K350_ROOTVNODE             0x01963000
#define K355_ROOTVNODE             0x01963040
#define K370_ROOTVNODE             0x0196F040
#define K400_ROOTVNODE             0x0206D250
#define K401_ROOTVNODE             0x0206D250
#define K405_ROOTVNODE             0x0206D250
#define K406_ROOTVNODE             0x0206D250
#define K407_ROOTVNODE             0x02071250
#define K450_ROOTVNODE             0x021AFA30
#define K455_ROOTVNODE             0x021AFA30
#define K470_ROOTVNODE             0x021B89E0
#define K471_ROOTVNODE             0x021B89E0
#define K472_ROOTVNODE             0x021B89E0
#define K473_ROOTVNODE             0x021B89E0
#define K474_ROOTVNODE             0x021B89E0
#define K500_ROOTVNODE             0x022C19F0
#define K501_ROOTVNODE             0x022C19F0
#define K503_ROOTVNODE             0x022C1A70
#define K505_ROOTVNODE             0x022C1A70
#define K507_ROOTVNODE             0x022C1A70
#define K550_ROOTVNODE             0x022EF570
#define K553_ROOTVNODE             0x022EF570
#define K555_ROOTVNODE             0x022F3570
#define K556_ROOTVNODE             0x022F3570
#define K600_ROOTVNODE             0x021BFAC0
#define K602_ROOTVNODE             0x021BFAC0
#define K620_ROOTVNODE             0x021C3AC0
#define K650_ROOTVNODE             0x02300320
#define K651_ROOTVNODE             0x02300320
#define K670_ROOTVNODE             0x02300320
#define K671_ROOTVNODE             0x02300320
#define K672_ROOTVNODE             0x02300320
#define K700_ROOTVNODE             0x022C5750
#define K701_ROOTVNODE             0x022C5750
#define K702_ROOTVNODE             0x022C5750
#define K750_ROOTVNODE             0x01B463E0
#define K751_ROOTVNODE             0x01B463E0
#define K755_ROOTVNODE             0x01B463E0
#define K800_ROOTVNODE             0x01B8C730
#define K801_ROOTVNODE             0x01B8C730
#define K803_ROOTVNODE             0x01B8C730
#define K850_ROOTVNODE             0x01C66150
#define K852_ROOTVNODE             0x01C66150
#define K900_ROOTVNODE             0x021EFF20
#define K903_ROOTVNODE             0x021EBF20
#define K904_ROOTVNODE             0x021EBF20
#define K950_ROOTVNODE             0x021A6C30
#define K951_ROOTVNODE             0x021A6C30
#define K960_ROOTVNODE             0x021A6C30
#define K1000_ROOTVNODE            0x01B25BD0
#define K1001_ROOTVNODE            0x01B25BD0
#define K1050_ROOTVNODE            0x01BF81F0
#define K1070_ROOTVNODE            0x01BF81F0
#define K1071_ROOTVNODE            0x01BF81F0
#define K1100_ROOTVNODE            0x02116640
#define K1102_ROOTVNODE            0x02116640
#define K1150_ROOTVNODE            0x02136E90
#define K1152_ROOTVNODE            0x02136E90
#define K1200_ROOTVNODE            0x02136E90
#define K1202_ROOTVNODE            0x02136E90
#define K1250_ROOTVNODE            0x02136E90
#define K1252_ROOTVNODE            0x02136E90


#define	KERN_XFAST_SYSCALL K1100_XFAST_SYSCALL//11
#define KERN_PROCESS_ASLR  0x00384285//11
#define KERN_PRISON_0      K1100_PRISON_0//11
#define KERN_ROOTVNODE     K1100_ROOTVNODE//11
#define KERN_PTRACE_CHECK  0x00384285//11

#define X86_CR0_WP (1 << 16)

int kernelPayload(struct thread *td, void* uap);